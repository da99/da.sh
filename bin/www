#!/usr/bin/env bash

THIS_DIR="$(dirname "$0")/.."

case "$*" in
  --help|help|-h)
  cmd="$(basename "$0")"
  echo "$cmd upload to bucket"
  echo "$cmd setup bucket"
  echo "$cmd write file manifest"
  echo "$cmd build mjs"
  echo "$cmd serve"
  echo "$cmd list old|new files"
  echo "$cmd public_file setup|prune|update"
  ;;

  "upload to bucket"|"setup bucket")
    bun run "$THIS_DIR"/src/Public_File.mts "$@"
  ;;

  "write file manifest")
    "$THIS_DIR"/src/Bucket.rb "$@"
  ;;

  "set src to "*)
    "$THIS_DIR"/src/PublicFile.rb "$@"
    ;;

  'build mjs')
    "$THIS_DIR"/src/PublicFile.rb build mjs
  ;;

  'list new files'|'list old files')
    bun run "$THIS_DIR"/src/Public_File.mts "$@"
  ;;

  'public_file '*)
    shift
    bun run "$THIS_DIR"/src/Public_File.mts "$@"
  ;;

  *)
    echo "!!! Unknown command: $*" >&2
    exit 1
  ;;
esac

